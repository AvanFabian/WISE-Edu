// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


enum UserRole {
  STUDENT
  TEACHER
  ADMIN
}

enum SubjectType {
  COMPULSORY
  GENERAL
}

model User {
  id               Int        @id @default(autoincrement())
  email            String     @unique
  name             String
  areasOfExpertise String?    // Only for teachers
  lastQuizTaken    DateTime?  // Only for students
  quizFrequency    Int?       // Only for students
  role             UserRole   @default(STUDENT)
  // Relations
  enrollments      Enrollment[]
  quizzesCreated   Quiz[]     @relation("QuizCreator")
}

model Subject {
  id           Int         @id @default(autoincrement())
  name         String
  type         SubjectType
  // Relations
  subSubjects  SubSubject[]
}

model SubSubject {
  id            Int      @id @default(autoincrement())
  name          String
  // Relations
  parentSubject Subject  @relation(fields: [subjectId], references: [id])
  subjectId     Int
}

model Enrollment {
  id        Int      @id @default(autoincrement())
  // Relations
  student   User     @relation(fields: [userId], references: [id])
  userId    Int
  lecture   Lecture  @relation(fields: [lectureId], references: [id])
  lectureId Int
}

model Lecture {
  id          Int        @id @default(autoincrement())
  // Relations
  enrollments Enrollment[]
  quizzes     Quiz[]
}

model Quiz {
  id         Int      @id @default(autoincrement())
  // Relations
  createdBy  User     @relation("QuizCreator", fields: [creatorId], references: [id])
  creatorId  Int
  lecture    Lecture  @relation(fields: [lectureId], references: [id])
  lectureId  Int
}
